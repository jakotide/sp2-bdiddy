import"./main-af214c2d.js";import{l as x,a as B}from"./hamburger-5bbfc2df.js";import{a as P}from"./read-eeac6ab1.js";import{A,L as D}from"./constants-88326297.js";import{g as k}from"./headers-246ce9a4.js";import{g as F}from"./getProfile-c65c363c.js";async function N(n,o){if(!o)throw new Error("Bid requires ID.");const r=`${A}${D}${o}/bids`;console.log(r);try{const e=await fetch(r,{method:"POST",headers:k(),body:JSON.stringify({amount:n})});if(e.ok)return await e.json();throw new Error("Something went wrong")}catch(e){console.error("Error:",e)}}const U=document.querySelectorAll("[data-carousel-button]");U.forEach(n=>{n.addEventListener("click",()=>{const o=n.dataset.carouselButton==="next"?1:-1,e=n.closest("[data-carousel]").querySelector("[data-slides]"),c=e.querySelector(".slideImg.active");let t=[...e.children].indexOf(c)+o;t<0&&(t=e.children.length-1),t>=e.children.length&&(t=0),e.querySelectorAll(".slideImg").forEach(i=>{i.classList.remove("active")}),e.children[t].classList.add("active")})});async function T(){const n=window.location.search,r=new URLSearchParams(n).get("id"),e=await P(r),c=[document.querySelector(".slide"),document.querySelector(".slide2"),document.querySelector(".slide3")],t=document.querySelector(".profileName"),i=document.querySelector(".img-box"),y=document.querySelector(".description"),L=document.querySelector(".start-end"),d=document.querySelector(".leader-flex"),u=[];for(let a=0;a<e.media.length;a++){const s=document.createElement("img");s.src=e.media[a],u.push(s)}const l=document.createElement("img");l.classList.add("border","img-avatar"),l.src=e.seller.avatar;const g=document.createElement("div");g.classList.add("profile-name"),g.textContent=e.seller.name;const w=document.createElement("h1");w.textContent=e.title;const S=document.createElement("p");S.classList.add(".description"),S.textContent=e.description;function b(a){const s=new Date(a),f={year:"numeric",month:"2-digit",day:"2-digit",hour:"numeric",minute:"numeric",hour12:!0};return new Intl.DateTimeFormat("en-US",f).format(s)}const h=document.createElement("div");h.classList.add("desktop-start-date"),h.textContent="Started: "+b(e.created);const v=document.createElement("div");v.classList.add("end"),v.textContent="Ends at: "+b(e.endsAt);function I(a){return a.reduce((s,f)=>f.amount>s.amount?f:s,a[0])}const m=I(e.bids);let q,p,E;m?(q=document.createElement("div"),q.textContent=m.amount+"$",p=document.createElement("div"),p.textContent=m.bidderName,p.classList.add("leader")):(E=document.createElement("div"),E.textContent="No bids yet!"),c.forEach((a,s)=>{a.append(u[s])}),i.append(l),t.append(g),y.append(w,S),L.append(h,v),m?d.append(p,q):d.append(E)}function $(){const n=document.querySelector(".bid-form"),o=document.querySelector(".bid-btn"),r=document.querySelector(".pluss"),e=document.querySelector(".minus"),c=document.querySelector("#amount");r.addEventListener("click",()=>{let t=parseInt(c.value,10)||0;t+=10,c.value=Math.max(t,0)}),e.addEventListener("click",()=>{let t=parseInt(c.value,10)||0;t-=10,t=Math.max(t,0),c.value=t}),n&&o.addEventListener("click",async t=>{t.preventDefault();const i=document.querySelector("input[name=amount]").value,y=window.location.search,d=new URLSearchParams(y).get("id"),u=x("User");if(!i||isNaN(i)||+i<=0){alert("Invalid amount. Please enter a valid bid amount.");return}try{u?(await N(+i,d),o.textContent="Success!",setTimeout(()=>{location.reload()},2e3)):alert("FAIL")}catch(l){console.log(l)}})}const C=document.querySelector(".bid-form"),O=document.querySelector(".login-message");C.addEventListener("submit",n=>{n.preventDefault()});async function V(){const n=document.querySelector(".availableFunds"),o=x("User");if(o&&o.name){const r=await F(o.name);r?n.innerText+="Funds available: "+r.credits+"$":console.error("Failed to fetch user profile")}else console.error("User not found or missing name property")}B(()=>{},()=>{C.style.display="none",O.style.display="block"});T();$();V();
