import"./main-a8e93a93.js";import{l as C,a as A}from"./hamburger-5bbfc2df.js";import{a as I}from"./read-eeac6ab1.js";import{A as D,L as N}from"./constants-88326297.js";import{g as F}from"./headers-246ce9a4.js";import{g as U}from"./getProfile-c65c363c.js";async function T(o,r){if(!r)throw new Error("Bid requires ID.");const a=`${D}${N}${r}/bids`;try{const e=await fetch(a,{method:"POST",headers:F(),body:JSON.stringify({amount:o})});if(e.ok)return await e.json();throw new Error("Something went wrong")}catch(e){console.error("Error:",e)}}const $=document.querySelectorAll("[data-carousel-button]");$.forEach(o=>{o.addEventListener("click",()=>{const r=o.dataset.carouselButton==="next"?1:-1,e=o.closest("[data-carousel]").querySelector("[data-slides]"),i=e.querySelector(".slideImg.active");let n=[...e.children].indexOf(i)+r;n<0&&(n=e.children.length-1),n>=e.children.length&&(n=0),e.querySelectorAll(".slideImg").forEach(c=>{c.classList.remove("active")}),e.children[n].classList.add("active")})});async function H(){const o=window.location.search,a=new URLSearchParams(o).get("id"),e=await I(a),i=[document.querySelector(".slide"),document.querySelector(".slide2"),document.querySelector(".slide3")],n=document.querySelector(".profileName"),c=document.querySelector(".img-box"),g=document.querySelector(".description"),w=document.querySelector(".start-end"),m=document.querySelector(".leader-flex"),l=[],d=document.querySelector(".next"),u=document.querySelector(".prev");for(let t=0;t<e.media.length;t++){const s=document.createElement("img");s.src=e.media[t],l.push(s)}if(e.media.length===0){const t=document.createElement("img");t.src="https://img.freepik.com/free-vector/illustration-gallery-icon_53876-27002.jpg?w=826&t=st=1702494458~exp=1702495058~hmac=d56fbe2332a59ded31ee5d1c49e38e5093f4405411d347c695155c6913e41d80",t.alt="No image available.",l.push(t),d.style.display="none",u.style.display="none"}else if(e.media.length===1){const t=document.createElement("img");t.src=e.media[0],l.push(t),d.style.display="none",u.style.display="none"}else{for(let t=0;t<e.media.length;t++){const s=document.createElement("img");s.src=e.media[t],l.push(s)}d.style.display="block",u.style.display="block"}const h=document.createElement("img");h.classList.add("border","img-avatar"),h.src=e.seller.avatar;const S=document.createElement("div");S.classList.add("profile-name"),S.textContent=e.seller.name;const x=document.createElement("h1");x.textContent=e.title;const v=document.createElement("p");v.classList.add(".description"),v.textContent=e.description;function B(t){const s=new Date(t),y={year:"numeric",month:"2-digit",day:"2-digit",hour:"numeric",minute:"numeric",hour12:!0};return new Intl.DateTimeFormat("en-US",y).format(s)}const q=document.createElement("div");q.classList.add("desktop-start-date"),q.textContent="Started: "+B(e.created);const b=document.createElement("div");b.classList.add("end"),b.textContent="Ends at: "+B(e.endsAt);function P(t){return t.reduce((s,y)=>y.amount>s.amount?y:s,t[0])}const p=P(e.bids);let E,f,L;p?(E=document.createElement("div"),E.textContent=p.amount+"$",f=document.createElement("div"),f.textContent=p.bidderName,f.classList.add("leader")):(L=document.createElement("div"),L.textContent="No bids yet!"),i.forEach((t,s)=>{t.append(l[s])}),c.append(h),n.append(S),g.append(x,v),w.append(q,b),p?m.append(f,E):m.append(L)}async function O(){const o=document.querySelector(".bid-form"),r=document.querySelector(".bid-btn"),a=document.querySelector(".pluss"),e=document.querySelector(".minus"),i=document.querySelector("#amount");a.addEventListener("click",()=>{let n=parseInt(i.value,10)||0;n+=10,i.value=Math.max(n,0)}),e.addEventListener("click",()=>{let n=parseInt(i.value,10)||0;n-=10,n=Math.max(n,0),i.value=n}),o&&r.addEventListener("click",async n=>{n.preventDefault();const c=document.querySelector("input[name=amount]").value,g=window.location.search,m=new URLSearchParams(g).get("id"),l=C("User");if(!c||isNaN(c)||+c<=0){alert("Invalid amount. Please enter a valid bid amount.");return}try{if(l){const d=await I(m),u=V(d.bids);if(u&&+c<=u.amount){alert("Your bid must be higher than the current highest bid.");return}await T(+c,m),r.textContent="Success!",setTimeout(()=>{location.reload()},2e3)}else alert("FAIL")}catch(d){console.log(d)}})}function V(o){return o.reduce((r,a)=>a.amount>r.amount?a:r,o[0])}const k=document.querySelector(".bid-form"),M=document.querySelector(".login-message");k.addEventListener("submit",o=>{o.preventDefault()});async function R(){const o=document.querySelector(".availableFunds"),r=C("User");if(r&&r.name){const a=await U(r.name);a?o.innerText+="Funds available: "+a.credits+"$":console.error("Failed to fetch user profile")}else console.error("User not found or missing name property")}A(()=>{},()=>{k.style.display="none",M.style.display="block"});H();O();R();
